<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="description" content="Massive view controller can a real problem regardless of what architecture you use. This post will show you a quick way to break them down."><meta name="author" content="Ian Keen"><meta og:site_name="Your ViewController isnâ€™t a View"><meta og:title="Your ViewController isnâ€™t a View"><meta og:description="Massive view controller can a real problem regardless of what architecture you use. This post will show you a quick way to break them down."><meta og:url="https://iankeen.tech"><meta twitter:card="summary"><meta twitter:site="@IanKay"><meta twitter:creator="@IanKay"><meta twitter:title="Your ViewController isnâ€™t a View"><meta twitter:description="Massive view controller can a real problem regardless of what architecture you use. This post will show you a quick way to break them down."><title>devbits: random development bits by Ian Keen</title><link rel="stylesheet" href="/Resources/style.css"><link rel="stylesheet" href="/Resources/swift.css"><link rel="shortcut icon" href="/Resources/favicon.ico"></head><body><div id="page-header"><a href="/"><div id="logo" class="wiggle"><p>devbits</p></div></a><div id="links"><div id="me"><a href="/workwithme/index.html">work with me</a><a href="/about/index.html">about</a></div><div id="social"><a href="https://www.twitter.com/IanKay"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTkgMGgtMTRjLTIuNzYxIDAtNSAyLjIzOS01IDV2MTRjMCAyLjc2MSAyLjIzOSA1IDUgNWgxNGMyLjc2MiAwIDUtMi4yMzkgNS01di0xNGMwLTIuNzYxLTIuMjM4LTUtNS01em0tLjEzOSA5LjIzN2MuMjA5IDQuNjE3LTMuMjM0IDkuNzY1LTkuMzMgOS43NjUtMS44NTQgMC0zLjU3OS0uNTQzLTUuMDMyLTEuNDc1IDEuNzQyLjIwNSAzLjQ4LS4yNzggNC44Ni0xLjM1OS0xLjQzNy0uMDI3LTIuNjQ5LS45NzYtMy4wNjYtMi4yOC41MTUuMDk4IDEuMDIxLjA2OSAxLjQ4Mi0uMDU2LTEuNTc5LS4zMTctMi42NjgtMS43MzktMi42MzMtMy4yNi40NDIuMjQ2Ljk0OS4zOTQgMS40ODYuNDExLTEuNDYxLS45NzctMS44NzUtMi45MDctMS4wMTYtNC4zODMgMS42MTkgMS45ODYgNC4wMzggMy4yOTMgNi43NjYgMy40My0uNDc5LTIuMDUzIDEuMDgtNC4wMyAzLjE5OS00LjAzLjk0MyAwIDEuNzk3LjM5OCAyLjM5NSAxLjAzNy43NDgtLjE0NyAxLjQ1MS0uNDIgMi4wODYtLjc5Ni0uMjQ2Ljc2Ny0uNzY2IDEuNDEtMS40NDMgMS44MTYuNjY0LS4wOCAxLjI5Ny0uMjU2IDEuODg1LS41MTctLjQzOS42NTYtLjk5NiAxLjIzNC0xLjYzOSAxLjY5N3oiLz48L3N2Zz4="></a><a href="https://www.github.com/IanKeen"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTkgMGgtMTRjLTIuNzYxIDAtNSAyLjIzOS01IDV2MTRjMCAyLjc2MSAyLjIzOSA1IDUgNWgxNGMyLjc2MiAwIDUtMi4yMzkgNS01di0xNGMwLTIuNzYxLTIuMjM4LTUtNS01em0tNC40NjYgMTkuNTljLS40MDUuMDc4LS41MzQtLjE3MS0uNTM0LS4zODR2LTIuMTk1YzAtLjc0Ny0uMjYyLTEuMjMzLS41NS0xLjQ4MSAxLjc4Mi0uMTk4IDMuNjU0LS44NzUgMy42NTQtMy45NDcgMC0uODc0LS4zMTItMS41ODgtLjgyMy0yLjE0Ny4wODItLjIwMi4zNTYtMS4wMTYtLjA3OS0yLjExNyAwIDAtLjY3MS0uMjE1LTIuMTk4LjgyLS42NC0uMTgtMS4zMjQtLjI2Ny0yLjAwNC0uMjcxLS42OC4wMDMtMS4zNjQuMDkxLTIuMDAzLjI2OS0xLjUyOC0xLjAzNS0yLjItLjgyLTIuMi0uODItLjQzNCAxLjEwMi0uMTYgMS45MTUtLjA3NyAyLjExOC0uNTEyLjU2LS44MjQgMS4yNzMtLjgyNCAyLjE0NyAwIDMuMDY0IDEuODY3IDMuNzUxIDMuNjQ1IDMuOTU0LS4yMjkuMi0uNDM2LjU1Mi0uNTA4IDEuMDctLjQ1Ny4yMDQtMS42MTQuNTU3LTIuMzI4LS42NjYgMCAwLS40MjMtLjc2OC0xLjIyNy0uODI1IDAgMC0uNzgtLjAxLS4wNTUuNDg3IDAgMCAuNTI1LjI0Ni44ODkgMS4xNyAwIDAgLjQ2MyAxLjQyOCAyLjY4OC45NDR2MS40ODljMCAuMjExLS4xMjkuNDU5LS41MjguMzg1LTMuMTgtMS4wNTctNS40NzItNC4wNTYtNS40NzItNy41OSAwLTQuNDE5IDMuNTgyLTggOC04czggMy41ODEgOCA4YzAgMy41MzMtMi4yODkgNi41MzEtNS40NjYgNy41OXoiLz48L3N2Zz4="></a><a href="https://iankeen.tech/feed.rss"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTkgMGgtMTRjLTIuNzYxIDAtNSAyLjIzOS01IDV2MTRjMCAyLjc2MSAyLjIzOSA1IDUgNWgxNGMyLjc2MiAwIDUtMi4yMzkgNS01di0xNGMwLTIuNzYxLTIuMjM4LTUtNS01em0tMTIuODMyIDIwYy0xLjE5NyAwLTIuMTY4LS45NjktMi4xNjgtMi4xNjVzLjk3MS0yLjE2NSAyLjE2OC0yLjE2NSAyLjE2Ny45NjkgMi4xNjcgMi4xNjUtLjk3IDIuMTY1LTIuMTY3IDIuMTY1em01LjE4IDBjLS4wNDEtNC4wMjktMy4zMTQtNy4yOTgtNy4zNDgtNy4zMzl2LTMuMjA3YzUuODE0LjA0MSAxMC41MTggNC43MzkgMTAuNTYxIDEwLjU0NmgtMy4yMTN6bTUuNDQxIDBjLS4wMjEtNy4wNjMtNS43MzYtMTIuNzYxLTEyLjc4OS0xMi43OTJ2LTMuMjA4YzguODMuMDMxIDE1Ljk4IDcuMTc5IDE2IDE2aC0zLjIxMXoiLz48L3N2Zz4="></a></div></div></div><div id="page-title"><h1 class="title plain">Your ViewController isnâ€™t a View</h1><h2 class="when">04 Dec 2017</h2><div id="tags"><div class="tag-container"><div class="tag"><a href="/tags/uikit/index.html">UIKit</a></div><div class="tag"><a href="/tags/mvc/index.html">MVC</a></div><div class="tag"><a href="/tags/mvvm/index.html">MVVM</a></div></div></div><div class="divider"></div></div><div id="page-content"><p>Today Iâ€™m going to step through a very under utilized way to slim down your <code>UIViewController</code>s.</p><h2>Example</h2><p>Lets look at a simple login screen:</p><p><img title="" src="/Resources/your_viewcontroller_isnt_a_view/example.gif"></p><h2>Breaking down View and ViewController</h2><p>Lets take a high level look at this screens functionality:</p><ul><li>Contains UI elements</li><li>Lays out UI elements</li><li>Performs Facebook login</li><li>Performs Google login</li><li>Toggles the loading indicator</li><li>Toggles the email login input</li><li>Toggles the keyboard</li><li>Resizing based on the keyboard</li><li>Performs email login</li></ul><p>This is pretty standard list for a screen like this and its common to see <em>all</em> of this contained in the view controller. Over time having a controller handling all these responsibilities can make it harder to understand as well as harder to <em>change</em>.</p><h3>Blurred lines</h3><p>Our first step to separating our code is to figure out what belongs where. What we want to do is group the items in our list in terms of how the screen <em>looks</em> vs what the screen <em>does</em>. This defines our <code>UIView</code> and <code>UIViewController</code> respectively.</p><p>This can be harder than it soundsâ€¦</p><p>As we move through each item you may notice some donâ€™t <em>really</em> fit completely in a single category.  Lets look at a few:</p><ul><li>Toggling the loading indicator: This is made up of how that should <em>look</em> but it can show or hide based on what the screen <em>does</em>.</li><li>Toggling the email login elements: This is a state transition so you might think to put that in the controller - however because it is a <em>view state</em> transition that doesnâ€™t rely on any outside logic it should really live in the view in this instance. Remember, theres no reason a view canâ€™t react to things like button taps!</li><li>Dealing with the keyboard can be especially tricky since it exists <em>outside</em> the immediate view hierarchy. Just use your best judgement when it comes to elements like this.</li></ul><p>Now that weâ€™ve had a think about these things lets break our original items out further to create our new lists.</p><h3>How it looks (UIView)</h3><ul><li>Contains UI elements</li><li>Appearance for social logins</li><li>Appearance for email login</li><li>Toggle appearance based on social/email state</li><li>Animate the loading indicator in/out</li><li>Show/hide keyboard</li></ul><h3>What it does (UIViewController) *</h3><ul><li>Performs Facebook login</li><li>Performs Google login</li><li>Performs email login</li><li>Show/hide loading indicator</li><li>Resize when keyboard shows/hides</li></ul><blockquote><p>* NOTE: view controllers accept user input and <em>trigger</em> actions like logging in. However you should not put all the code that <em>performs</em> these actions there. Please use separate service objects in conjunction with this technique.</p></blockquote><p>We can see that what this screen <em>really</em> does is much more than we originally thought. However now that we have a clearer separation of concerns we can break the original view controller down into a separate view and controller that handle their own, distinct, roles.</p><p>So once we have moved the view code into a custom <code>UIView</code> how do we bring that into a <code>UIViewController</code>?</p><h2>Code UI</h2><p>You have no doubt used a number of overrides in <code>UIViewController</code> . <code>viewDidLoad</code>, <code>viewDidAppear</code> etc.. however there is a lesser known override called <code>loadView</code>.</p><h3>Custom Views</h3><p><code>loadView</code> allows you to insert a custom <code>UIView</code> that the <code>UIViewController</code> will use as its <code>view</code> simply by assigning it, for example:</p><pre><code class="language-swift"><span class="keyword">override</span><span class="none"> </span><span class="keyword">func</span><span class="none"> </span><span class="identifier">loadView</span><span class="none">() {
    </span><span class="keyword">self</span><span class="none">.</span><span class="identifier">view</span><span class="none"> = </span><span class="identifier">MyCustomView</span><span class="none">()
}
</span></code></pre><h3>Accessing the custom view</h3><p>How that our custom view is loaded we want typed access to it. The most straight forward way to do this is with a computed property:</p><pre><code class="language-swift"><span class="keyword">var</span><span class="none"> </span><span class="identifier">customView</span><span class="none">: </span><span class="type">MyCustomView</span><span class="none"> { </span><span class="keyword">return</span><span class="none"> </span><span class="identifier">view</span><span class="none"> </span><span class="keyword">as</span><span class="none">! </span><span class="type">MyCustomView</span><span class="none"> }
</span></code></pre><p>Now in your <code>UIViewController</code> you access the typed version of the view via the new  <code>customView</code> property instead of <code>self.view</code>  (the <code>!</code> is safe here as we can guarantee <code>view</code> will always be <code>MyCustomView</code>)</p><h3>Bonus</h3><p>Here is a nice generic <code>UIViewController</code> subclass I like to use to simplify this pattern.</p><pre><code class="language-swift"><span class="keyword">class</span><span class="none"> </span><span class="identifier">ViewController</span><span class="none">&lt;</span><span class="identifier">T</span><span class="none">: </span><span class="type">UIView</span><span class="none">&gt;: </span><span class="type">UIViewController</span><span class="none"> {
    </span><span class="comment">// MARK: - View Separation</span><span class="none">
    </span><span class="keyword">var</span><span class="none"> </span><span class="identifier">customView</span><span class="none">: </span><span class="type">T</span><span class="none"> { </span><span class="keyword">return</span><span class="none"> </span><span class="identifier">view</span><span class="none"> </span><span class="keyword">as</span><span class="none">! </span><span class="type">T</span><span class="none"> }

    </span><span class="comment">// MARK: - Lifecycle</span><span class="none">
    </span><span class="keyword">override</span><span class="none"> </span><span class="keyword">func</span><span class="none"> </span><span class="identifier">loadView</span><span class="none">() {
        </span><span class="keyword">self</span><span class="none">.</span><span class="identifier">view</span><span class="none"> = </span><span class="identifier">T</span><span class="none">()
    }
}
</span></code></pre><p>With this you can define your view controllers as:</p><pre><code class="language-swift"><span class="keyword">class</span><span class="none"> </span><span class="identifier">MyViewController</span><span class="none">: </span><span class="type">ViewController</span><span class="none">&lt;</span><span class="type">MyView</span><span class="none">&gt; {
   </span><span class="comment">//you now get a `customView` property typed as `MyView` for free</span><span class="none">
}
</span></code></pre><h2>Storyboard / Nib UI</h2><p>The process for storyboards and nibs are the same.</p><h3>Custom Views</h3><p>Open the storyboard or nib, find your view controllers view in Interface Builders document outline.<img title="" src="/Resources/your_viewcontroller_isnt_a_view/outline.png"></p><p>In the identity inspector update the view class to the type of your custom view.<img title="" src="/Resources/your_viewcontroller_isnt_a_view/inspector.png"></p><h3>Accessing the custom view</h3><p>As with the code based method, we will want typed access to our custom view. We use a computed property again however this time it will be an <code>IBOutlet</code>:</p><pre><code class="language-swift"><span class="keyword">@IBOutlet</span><span class="none"> </span><span class="keyword">private</span><span class="none"> </span><span class="keyword">var</span><span class="none"> </span><span class="identifier">customView</span><span class="none">: </span><span class="type">MyCustomView</span><span class="none">!
</span></code></pre><p>Finally we just need to hook the <code>IBOutlet</code> from the <code>UIViewController</code> to the custom <code>UIView</code>.<img title="" src="/Resources/your_viewcontroller_isnt_a_view/outlet.png"></p><h2>Results</h2><p>So what have we achieved?</p><p>We have defined a clearer separation of concerns between a view and a controller.  Now our view can focus solely on how a screen <em>looks</em> and the controller can focus on what a screen <em>does</em>.</p><p>This is a technique you can use regardless of whether you build your UIs with code, nibs or storyboards <em>and</em> it will work with any architecture or pattern.</p><p>Speaking of patternsâ€¦ this one is called MVC ðŸ˜„</p><p>You can download a project with an example of all three UI methods <a href="/Resources/your_viewcontroller_isnt_a_view/your-viewcontroller-isnt-a-view.zip">here</a></p></div><div id="page-footer"><div class="divider"></div><p>(c) Ian Keen</p></div></body></html>